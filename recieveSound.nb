(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     19126,        565]
NotebookOptionsPosition[     17840,        516]
NotebookOutlinePosition[     18173,        531]
CellTagsIndexPosition[     18130,        528]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.683290395525502*^9, 3.683290411572288*^9}}],

Cell[CellGroupData[{

Cell["Import constants", "Chapter",
 CellChangeTimes->{{3.6830291668282623`*^9, 3.683029173150951*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"baud", "=", "0.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"samplingRate", "=", "16000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"frequencies", "=", 
   RowBox[{"{", 
    RowBox[{
    "697", ",", "770", ",", "852", ",", "941", ",", "1209", ",", "1336", ",", 
     "1477", ",", "1633"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrix", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "15"}], "]"}], ",", "4"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.683029019749971*^9, 3.6830290213648767`*^9}, {
  3.68302914372928*^9, 3.683029158428391*^9}, {3.683029679963648*^9, 
  3.683029682972226*^9}, {3.683282786716475*^9, 3.6832828143980618`*^9}, {
  3.683282850431534*^9, 3.683282851953952*^9}, {3.683282927206225*^9, 
  3.683282927880684*^9}, {3.683283223223445*^9, 3.6832832499479637`*^9}, {
  3.6832851733659763`*^9, 3.6832851735223417`*^9}, {3.683288241118288*^9, 
  3.683288243481235*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"soundData", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"\"\<NathanJared.wav\>\"", ",", "\"\<Data\>\""}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.68328692043331*^9, 3.683286922346324*^9}, {
   3.683287053909931*^9, 3.683287080049789*^9}, 3.683290390371447*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
          "0.3756523331400494`", ",", "0.6899624622333446`", ",", 
           "0.8881801812799462`", ",", "0.9408551286355175`", ",", 
           "0.8459425641651662`", ",", 
           TemplateBox[{"79990"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> {{1, 1}, {1, 2}}, 
              FrameStyle -> None, RoundingRadius -> 7]& )], ",", 
           "0.7697378460036012`", ",", "0.9164708395641957`", ",", 
           "0.815637684255501`", ",", "0.4781945249794`", ",", 
           RowBox[{"-", "0.00286865234375`"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{70., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{62., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 6, 20713189244708524984, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 6, 20713189244708524984, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{52., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 6, 20713189244708524984, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{91., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[6]]], "Output",
 CellChangeTimes->{3.683287083659927*^9, 3.683288247098432*^9, 
  3.68329034876936*^9, 3.683290422080915*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["chunk to index", "Chapter",
 CellChangeTimes->{{3.683289559496811*^9, 3.683289565321349*^9}}],

Cell["\<\
fftToIndex takes in an FFT and converts the two highest frequencies to the \
indexes of frequencies list.\
\>", "Text",
 CellChangeTimes->{{3.6832901658852663`*^9, 3.683290239677813*^9}, {
  3.683290317449589*^9, 3.683290317757372*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fftToIndex", "[", "fftChunk_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"List", "/@", 
     RowBox[{"Sort", "@@", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Ordering", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"frequencies", "-", "#"}], "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{"Ordering", "[", 
            RowBox[{"fftChunk", ",", 
             RowBox[{"-", "2"}]}], "]"}], "*", "2"}]}], "]"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68328996347855*^9, 3.6832900056633368`*^9}, {
  3.683290705214958*^9, 3.683290713946321*^9}, {3.6832907608237123`*^9, 
  3.683290813276031*^9}, {3.683290921431168*^9, 3.683291014573824*^9}, {
  3.683291056458827*^9, 3.683291064316821*^9}, {3.683291148426062*^9, 
  3.68329115378159*^9}}],

Cell["\<\
soundToIndex takes in a sound, partitions the data into properly sized \
chunks, and maps the chunks through fftToIndex to return a list of lists of \
the frequency list\
\>", "Text",
 CellChangeTimes->{{3.6832902487081003`*^9, 3.6832903119651527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soundToIndex", "[", 
   RowBox[{
   "soundData_", ",", "baud_", ",", "samplingRate_", ",", "frequencies_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "chunks", ",", "fftChunks"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"baud", "*", "samplingRate"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"chunks", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"soundData", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fftChunks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Fourier", "[", "#", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           FractionBox["n", "2"]}], "]"}], "]"}], "&"}], "/@", "chunks"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fftToIndex", "/@", "fftChunks"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.683289570617015*^9, 3.683289866673732*^9}, {
  3.68329001668503*^9, 3.683290029694623*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"indeces", "=", 
  RowBox[{"soundToIndex", "[", 
   RowBox[{
   "soundData", ",", "baud", ",", "samplingRate", ",", "frequencies"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.683290061241637*^9, 3.683290068428722*^9}, {
  3.683290334122164*^9, 3.683290339872355*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "8", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.683290069113083*^9, 3.6832903491370573`*^9, 3.683290422245104*^9, {
   3.683290744302685*^9, 3.683290815470912*^9}, {3.683290931365451*^9, 
   3.6832910172227993`*^9}, 3.68329106636128*^9, 3.6832911583268213`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"indeces", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6832904936623383`*^9, 3.6832905304892263`*^9}, {
  3.6832908352802467`*^9, 3.683290843453706*^9}, {3.6832908767698298`*^9, 
  3.683290901038095*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "5", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.683290880571397*^9, 3.6832909061554327`*^9}, 
   3.6832911607978363`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.68329055887757*^9, 3.68329059140774*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \
\\\";;\\\", \\\"1\\\"}], \\\"}\\\"}]\\) cannot be used as a part \
specification.\"",2,13,6,20713189244708524984,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.683290587655107*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "9", ",", "10", ",", "11"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"12", ",", "13", ",", "14", ",", "15"}], "}"}]}], "}"}], 
  "\[LeftDoubleBracket]", 
  RowBox[{"{", 
   RowBox[{"1", ";;", "1"}], "}"}], "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.68329057263663*^9, 3.683290587680068*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrix", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"indeces", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.683290650122267*^9, 3.6832906930809717`*^9}, {
  3.683291171577157*^9, 3.683291211038803*^9}, {3.683291258478839*^9, 
  3.683291380038444*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.683290656145924*^9, 3.683290693434127*^9}, {
   3.6832911913434887`*^9, 3.683291211314859*^9}, 3.683291282928247*^9, {
   3.68329133444802*^9, 3.683291342156831*^9}, 3.683291372432159*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"indeces", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "-", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "4", "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.683291135381674*^9, 3.683291170151475*^9}, {
  3.683291384020842*^9, 3.683291418035388*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.683291384366542*^9, 3.683291418404418*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{636, 1041},
WindowMargins->{{2, Automatic}, {2, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 189, 4, 35, "Input"],
Cell[CellGroupData[{
Cell[772, 28, 103, 1, 66, "Chapter"],
Cell[878, 31, 1000, 23, 91, "Input"],
Cell[CellGroupData[{
Cell[1903, 58, 286, 6, 32, "Input"],
Cell[2192, 66, 8145, 207, 139, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10386, 279, 99, 1, 66, "Chapter"],
Cell[10488, 282, 246, 5, 55, "Text"],
Cell[10737, 289, 1029, 27, 144, "Input"],
Cell[11769, 318, 263, 5, 77, "Text"],
Cell[12035, 325, 1171, 32, 228, "Input"],
Cell[CellGroupData[{
Cell[13231, 361, 293, 7, 59, "Input"],
Cell[13527, 370, 1401, 46, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14965, 421, 255, 5, 32, "Input"],
Cell[15223, 428, 217, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15477, 439, 90, 1, 30, "Input"],
Cell[15570, 442, 324, 7, 23, "Message"],
Cell[15897, 451, 567, 15, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16501, 471, 434, 12, 35, "Input"],
Cell[16938, 485, 328, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17303, 496, 319, 9, 32, "Input"],
Cell[17625, 507, 187, 5, 32, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

