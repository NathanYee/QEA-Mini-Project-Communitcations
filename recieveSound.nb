(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11298,        347]
NotebookOptionsPosition[     10315,        310]
NotebookOutlinePosition[     10648,        325]
CellTagsIndexPosition[     10605,        322]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.683290395525502*^9, 3.683290411572288*^9}}],

Cell[CellGroupData[{

Cell["Import constants", "Chapter",
 CellChangeTimes->{{3.6830291668282623`*^9, 3.683029173150951*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"baud", "=", "0.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"samplingRate", "=", "16000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"frequencies", "=", 
   RowBox[{"{", 
    RowBox[{
    "697", ",", "770", ",", "852", ",", "941", ",", "1209", ",", "1336", ",", 
     "1477", ",", "1633"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrix", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "15"}], "]"}], ",", "4"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.683029019749971*^9, 3.6830290213648767`*^9}, {
  3.68302914372928*^9, 3.683029158428391*^9}, {3.683029679963648*^9, 
  3.683029682972226*^9}, {3.683282786716475*^9, 3.6832828143980618`*^9}, {
  3.683282850431534*^9, 3.683282851953952*^9}, {3.683282927206225*^9, 
  3.683282927880684*^9}, {3.683283223223445*^9, 3.6832832499479637`*^9}, {
  3.6832851733659763`*^9, 3.6832851735223417`*^9}, {3.683288241118288*^9, 
  3.683288243481235*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soundData", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<NathanJared.wav\>\"", ",", "\"\<Data\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.68328692043331*^9, 3.683286922346324*^9}, {
   3.683287053909931*^9, 3.683287080049789*^9}, 3.683290390371447*^9, 
   3.68348757628811*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["chunk to index", "Chapter",
 CellChangeTimes->{{3.683289559496811*^9, 3.683289565321349*^9}}],

Cell["\<\
fftToIndex takes in an FFT and converts the two highest frequencies to the \
indexes of frequencies list.\
\>", "Text",
 CellChangeTimes->{{3.6832901658852663`*^9, 3.683290239677813*^9}, {
  3.683290317449589*^9, 3.683290317757372*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fftToIndex", "[", "fftChunk_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"List", "/@", 
     RowBox[{"Sort", "@@", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Ordering", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"frequencies", "-", "#"}], "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{"Ordering", "[", 
            RowBox[{"fftChunk", ",", 
             RowBox[{"-", "2"}]}], "]"}], "*", "2"}]}], "]"}]}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68328996347855*^9, 3.6832900056633368`*^9}, {
  3.683290705214958*^9, 3.683290713946321*^9}, {3.6832907608237123`*^9, 
  3.683290813276031*^9}, {3.683290921431168*^9, 3.683291014573824*^9}, {
  3.683291056458827*^9, 3.683291064316821*^9}, {3.683291148426062*^9, 
  3.68329115378159*^9}}],

Cell["\<\
soundToIndex takes in a sound, partitions the data into properly sized \
chunks, and maps the chunks through fftToIndex to return a list of lists of \
the frequency list\
\>", "Text",
 CellChangeTimes->{{3.6832902487081003`*^9, 3.6832903119651527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soundToIndex", "[", 
   RowBox[{
   "soundData_", ",", "baud_", ",", "samplingRate_", ",", "frequencies_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "chunks", ",", "fftChunks"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"baud", "*", "samplingRate"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"chunks", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"soundData", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fftChunks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Fourier", "[", "#", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           FractionBox["n", "2"]}], "]"}], "]"}], "&"}], "/@", "chunks"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fftToIndex", "/@", "fftChunks"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.683289570617015*^9, 3.683289866673732*^9}, {
  3.68329001668503*^9, 3.683290029694623*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"indeces", "=", 
  RowBox[{"soundToIndex", "[", 
   RowBox[{
   "soundData", ",", "baud", ",", "samplingRate", ",", "frequencies"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.683290061241637*^9, 3.683290068428722*^9}, {
  3.683290334122164*^9, 3.683290339872355*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "7", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "8", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.683290069113083*^9, 3.6832903491370573`*^9, 3.683290422245104*^9, {
   3.683290744302685*^9, 3.683290815470912*^9}, {3.683290931365451*^9, 
   3.6832910172227993`*^9}, 3.68329106636128*^9, 3.6832911583268213`*^9, 
   3.68329207824293*^9, 3.683485457030493*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"indexToNumber", "[", 
   RowBox[{"index_", ",", "matrix_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "indexlistlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"indexlistlist", "=", 
      RowBox[{"index", "-", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "@", 
      RowBox[{"matrix", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"indexlistlist", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"indexlistlist", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.683292164541423*^9, 3.683292258557331*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nibbleToString", "[", "nums_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "bytes", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bytes", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PadLeft", "[", 
            RowBox[{"#", ",", "4"}], "]"}], "&"}], "/@", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "nums", "]"}], ",", "2"}], "]"}]}], "]"}],
         ",", "8"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FromCharacterCode", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FromDigits", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "bytes"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.683485608137965*^9, 3.683485693116095*^9}, {
  3.683485941603291*^9, 3.683486012232511*^9}, {3.683486043152923*^9, 
  3.6834861918568*^9}, {3.683486240816868*^9, 3.683486390688871*^9}, {
  3.6834864393140707`*^9, 3.683486509112481*^9}, {3.683486546667815*^9, 
  3.683486580213122*^9}, {3.68348668284449*^9, 3.683486848440041*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.683485958736248*^9, {3.6834860181810207`*^9, 3.683486019795529*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"decode", "[", 
   RowBox[{
   "soundData_", ",", "baud_", ",", "samplingRate_", ",", "frequencies_", ",",
     "matrix_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "nums", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nums", "=", 
      RowBox[{"soundToIndex", "[", 
       RowBox[{
       "soundData", ",", "baud", ",", "samplingRate", ",", "frequencies"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nibbleToString", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"indexToNumber", "[", 
         RowBox[{"#", ",", "matrix"}], "]"}], "&"}], "/@", "nums"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6834870500423203`*^9, 3.683487278285829*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"decode", "[", 
  RowBox[{
  "soundData", ",", "baud", ",", "samplingRate", ",", "frequencies", ",", 
   "matrix"}], "]"}]], "Input",
 CellChangeTimes->{{3.6834872833540907`*^9, 3.683487284952023*^9}, {
  3.68348742187352*^9, 3.683487433379035*^9}}],

Cell[BoxData["\<\"Nathan and Jared,!@#$%^&*12345lkdsfahlksjadfh\"\>"], \
"Output",
 CellChangeTimes->{{3.683487435508823*^9, 3.683487464049377*^9}, 
   3.683487580349757*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{476, 1041},
WindowMargins->{{2, Automatic}, {2, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 189, 4, 35, "Input"],
Cell[CellGroupData[{
Cell[772, 28, 103, 1, 66, "Chapter"],
Cell[878, 31, 1000, 23, 131, "Input"],
Cell[1881, 56, 332, 8, 109, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2250, 69, 99, 1, 66, "Chapter"],
Cell[2352, 72, 246, 5, 77, "Text"],
Cell[2601, 79, 1029, 27, 170, "Input"],
Cell[3633, 108, 263, 5, 99, "Text"],
Cell[3899, 115, 1171, 32, 271, "Input"],
Cell[CellGroupData[{
Cell[5095, 151, 293, 7, 59, "Input"],
Cell[5391, 160, 1448, 47, 92, "Output"]
}, Open  ]],
Cell[6854, 210, 828, 23, 128, "Input"],
Cell[7685, 235, 1214, 29, 179, "Input"],
Cell[8902, 266, 119, 2, 30, "Input"],
Cell[9024, 270, 789, 21, 179, "Input"],
Cell[CellGroupData[{
Cell[9838, 295, 272, 6, 59, "Input"],
Cell[10113, 303, 174, 3, 51, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

